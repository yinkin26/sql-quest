<!DOCTYPE html>
<html lang="en" class="pixel-art dark-theme">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL Quest - SQL BETWEEN</title>
    <link rel="stylesheet" href="stylesheets/style.css" />
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <script src="javascripts/loadComponents.js" defer></script>
    <script src="javascripts/script.js" defer></script>
    <script src="javascripts/lessonTracker.js" defer></script>
</head>
<body class="pixel-art dark-theme">
    <div id="header"></div>
    <div class="lesson-layout">
        <section class="lesson">
            <div class="lesson-header">
                <h1>üìä SQL BETWEEN</h1>
                <div class="bookmark-container">
                    <button id="bookmarkBtn" class="bookmark-btn" onclick="toggleBookmark('between')">
                        <span class="bookmark-icon">üîñ</span>
                        <span class="bookmark-text">Bookmark</span>
                    </button>
                    <span id="bookmarkStatus"></span>
                </div>
            </div>

            <h3>ü§î What is BETWEEN?</h3>
            <p>The <strong>BETWEEN</strong> operator is a powerful SQL tool that allows you to filter data within a specific range of values. It provides an elegant and readable way to select records where a column value falls within a specified minimum and maximum range, making it essential for date ranges, numeric intervals, and alphabetical sorting.</p>
            
            <p><strong>BETWEEN is essential for:</strong></p>
            <ul>
                <li><strong>Date Range Filtering</strong>: Select records within specific time periods</li>
                <li><strong>Numeric Range Analysis</strong>: Filter data by price ranges, age groups, or scores</li>
                <li><strong>Alphabetical Sorting</strong>: Find records within alphabetical ranges</li>
                <li><strong>Performance Optimization</strong>: More efficient than multiple comparison operators</li>
                <li><strong>Data Analysis</strong>: Essential for statistical analysis and reporting</li>
                <li><strong>Business Intelligence</strong>: Critical for dashboard filtering and KPI analysis</li>
                <li><strong>Quality Control</strong>: Validate data within acceptable ranges</li>
                <li><strong>Financial Analysis</strong>: Filter transactions, budgets, and financial metrics</li>
            </ul>
            
            <p><strong>How BETWEEN Works:</strong></p>
            <div class="code-block">
                <pre><code>-- BETWEEN operator: Returns TRUE if value is within the range (inclusive)
column_name BETWEEN value1 AND value2
-- Equivalent to:
column_name >= value1 AND column_name <= value2

-- NOT BETWEEN operator: Returns TRUE if value is outside the range
column_name NOT BETWEEN value1 AND value2
-- Equivalent to:
column_name < value1 OR column_name > value2</code></pre>
            </div>
            
            <p><strong>Real-World Applications:</strong></p>
            <div class="code-block">
                <pre><code>-- E-commerce: Find products in a price range
SELECT * FROM products WHERE price BETWEEN 50 AND 200;

-- HR: Find employees hired in a specific year
SELECT * FROM employees WHERE hire_date BETWEEN '2020-01-01' AND '2020-12-31';

-- Analytics: Find sales within a revenue range
SELECT * FROM sales WHERE total_amount BETWEEN 1000 AND 5000;</code></pre>
            </div>

            <h3>üìù Basic Syntax</h3>
            <div class="code-block">
                <pre><code>-- Basic BETWEEN syntax
SELECT column1, column2
FROM table_name
WHERE column_name BETWEEN value1 AND value2;

-- NOT BETWEEN syntax
SELECT column1, column2
FROM table_name
WHERE column_name NOT BETWEEN value1 AND value2;

-- BETWEEN with dates
SELECT column1, column2
FROM table_name
WHERE date_column BETWEEN 'start_date' AND 'end_date';

-- BETWEEN with strings (alphabetical range)
SELECT column1, column2
FROM table_name
WHERE text_column BETWEEN 'A' AND 'M';</code></pre>
            </div>
            
            <p><strong>Key Components:</strong></p>
            <ul>
                <li><strong>Column Name</strong>: The field you want to filter</li>
                <li><strong>Lower Bound</strong>: The minimum value (inclusive)</li>
                <li><strong>Upper Bound</strong>: The maximum value (inclusive)</li>
                <li><strong>Data Types</strong>: Works with numbers, dates, and strings</li>
                <li><strong>Inclusivity</strong>: Both boundary values are included in the result</li>
            </ul>
            
            <p><strong>Important Considerations:</strong></p>
            <div class="code-block">
                <pre><code>-- BETWEEN is inclusive of both boundary values
SELECT * FROM products WHERE price BETWEEN 100 AND 200;
-- This includes products with price = 100 AND price = 200

-- Order matters: value1 should be <= value2
SELECT * FROM products WHERE price BETWEEN 100 AND 200;  -- Correct
SELECT * FROM products WHERE price BETWEEN 200 AND 100;  -- Returns no results

-- Date considerations
-- Be careful with time components in datetime fields
SELECT * FROM orders 
WHERE order_date BETWEEN '2023-01-01' AND '2023-01-31 23:59:59';

-- String comparisons are case-sensitive and based on collation
SELECT * FROM customers WHERE last_name BETWEEN 'A' AND 'M';

-- NULL handling
-- BETWEEN returns NULL if any operand is NULL
SELECT * FROM table WHERE column BETWEEN NULL AND 100;  -- Returns no results</code></pre>
            </div>

            <h3>üß™ Try It Yourself</h3>
            <div class="code-block">
                <div class="editor-container">
                    <div class="editor-header">
                        <span>SQL Editor</span>
                        <button onclick="runQuery()" class="run-btn">‚ñ∂ Run Query</button>
                    </div>
                    <textarea id="sqlEditor" placeholder="-- Try writing a BETWEEN query here\nSELECT name, price FROM products WHERE price BETWEEN 50 AND 150;">SELECT name, price FROM products WHERE price BETWEEN 50 AND 150;</textarea>
                </div>
                <div class="result-container">
                    <div class="result-header">Query Result</div>
                    <div id="queryResult" class="result-content">
                        <p>Click "Run Query" to see results</p>
                    </div>
                </div>
            </div>

            <h3>üí° Examples</h3>
            
            <h4>1. E-commerce Price Range Analysis</h4>
            <div class="code-block">
                <pre><code>-- Find products in different price ranges
SELECT 
    product_id,
    product_name,
    category,
    price,
    stock_quantity,
    CASE 
        WHEN price BETWEEN 0 AND 25 THEN 'Budget'
        WHEN price BETWEEN 26 AND 100 THEN 'Mid-Range'
        WHEN price BETWEEN 101 AND 500 THEN 'Premium'
        ELSE 'Luxury'
    END as price_category
FROM products
WHERE price BETWEEN 10 AND 1000
  AND stock_quantity > 0
ORDER BY price_category, price ASC;

-- Analyze sales performance by price range
SELECT 
    CASE 
        WHEN price BETWEEN 0 AND 50 THEN '$0-$50'
        WHEN price BETWEEN 51 AND 100 THEN '$51-$100'
        WHEN price BETWEEN 101 AND 200 THEN '$101-$200'
        ELSE 'Over $200'
    END as price_range,
    COUNT(*) as product_count,
    AVG(price) as avg_price,
    SUM(stock_quantity) as total_inventory
FROM products
WHERE price BETWEEN 0 AND 500
GROUP BY 
    CASE 
        WHEN price BETWEEN 0 AND 50 THEN '$0-$50'
        WHEN price BETWEEN 51 AND 100 THEN '$51-$100'
        WHEN price BETWEEN 101 AND 200 THEN '$101-$200'
        ELSE 'Over $200'
    END
ORDER BY avg_price;</code></pre>
            </div>
            
            <h4>2. Date Range and Time-Based Analysis</h4>
            <div class="code-block">
                <pre><code>-- Find orders within a specific date range
SELECT 
    order_id,
    customer_id,
    order_date,
    total_amount,
    status,
    DATEDIFF(CURRENT_DATE, order_date) as days_ago
FROM orders
WHERE order_date BETWEEN '2023-01-01' AND '2023-12-31'
  AND total_amount BETWEEN 100 AND 1000
ORDER BY order_date DESC, total_amount DESC;

-- Monthly sales analysis for the current year
SELECT 
    MONTH(order_date) as month_number,
    MONTHNAME(order_date) as month_name,
    COUNT(*) as total_orders,
    SUM(total_amount) as total_revenue,
    AVG(total_amount) as avg_order_value,
    MIN(total_amount) as min_order,
    MAX(total_amount) as max_order
FROM orders
WHERE order_date BETWEEN DATE_FORMAT(CURRENT_DATE, '%Y-01-01') 
                     AND DATE_FORMAT(CURRENT_DATE, '%Y-12-31')
  AND status IN ('Completed', 'Shipped', 'Delivered')
GROUP BY MONTH(order_date), MONTHNAME(order_date)
ORDER BY month_number;

-- Find employees hired in the last 5 years
SELECT 
    employee_id,
    CONCAT(first_name, ' ', last_name) as full_name,
    department,
    job_title,
    hire_date,
    salary,
    DATEDIFF(CURRENT_DATE, hire_date) / 365 as years_employed
FROM employees
WHERE hire_date BETWEEN DATE_SUB(CURRENT_DATE, INTERVAL 5 YEAR) 
                    AND CURRENT_DATE
  AND salary BETWEEN 40000 AND 150000
ORDER BY hire_date DESC;</code></pre>
            </div>
            
            <h4>3. Financial and Performance Analysis</h4>
            <div class="code-block">
                <pre><code>-- Analyze customer spending patterns
SELECT 
    customer_id,
    CONCAT(first_name, ' ', last_name) as customer_name,
    total_spent,
    total_orders,
    AVG(total_spent / total_orders) as avg_order_value,
    CASE 
        WHEN total_spent BETWEEN 0 AND 500 THEN 'Bronze'
        WHEN total_spent BETWEEN 501 AND 2000 THEN 'Silver'
        WHEN total_spent BETWEEN 2001 AND 5000 THEN 'Gold'
        ELSE 'Platinum'
    END as customer_tier
FROM customers
WHERE total_spent BETWEEN 100 AND 10000
  AND total_orders BETWEEN 2 AND 50
ORDER BY total_spent DESC;

-- Revenue analysis by transaction size
SELECT 
    CASE 
        WHEN total_amount BETWEEN 0 AND 100 THEN 'Small ($0-$100)'
        WHEN total_amount BETWEEN 101 AND 500 THEN 'Medium ($101-$500)'
        WHEN total_amount BETWEEN 501 AND 1000 THEN 'Large ($501-$1000)'
        ELSE 'Enterprise ($1000+)'
    END as transaction_size,
    COUNT(*) as transaction_count,
    SUM(total_amount) as total_revenue,
    AVG(total_amount) as avg_transaction_value,
    ROUND((COUNT(*) * 100.0 / (SELECT COUNT(*) FROM orders)), 2) as percentage_of_total
FROM orders
WHERE order_date BETWEEN DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR) AND CURRENT_DATE
  AND status = 'Completed'
GROUP BY 
    CASE 
        WHEN total_amount BETWEEN 0 AND 100 THEN 'Small ($0-$100)'
        WHEN total_amount BETWEEN 101 AND 500 THEN 'Medium ($101-$500)'
        WHEN total_amount BETWEEN 501 AND 1000 THEN 'Large ($501-$1000)'
        ELSE 'Enterprise ($1000+)'
    END
ORDER BY total_revenue DESC;</code></pre>
            </div>
            
            <h4>4. Inventory and Stock Management</h4>
            <div class="code-block">
                <pre><code>-- Inventory analysis by stock levels
SELECT 
    product_id,
    product_name,
    category,
    stock_quantity,
    price,
    (stock_quantity * price) as inventory_value,
    CASE 
        WHEN stock_quantity BETWEEN 0 AND 10 THEN 'Critical'
        WHEN stock_quantity BETWEEN 11 AND 50 THEN 'Low'
        WHEN stock_quantity BETWEEN 51 AND 200 THEN 'Normal'
        ELSE 'High'
    END as stock_status
FROM products
WHERE price BETWEEN 5 AND 500
  AND category NOT IN ('Discontinued', 'Seasonal')
ORDER BY 
    CASE 
        WHEN stock_quantity BETWEEN 0 AND 10 THEN 1
        WHEN stock_quantity BETWEEN 11 AND 50 THEN 2
        WHEN stock_quantity BETWEEN 51 AND 200 THEN 3
        ELSE 4
    END,
    inventory_value DESC;

-- Products requiring reorder (low stock in specific price ranges)
SELECT 
    p.product_id,
    p.product_name,
    p.category,
    p.stock_quantity,
    p.price,
    p.reorder_level,
    (p.reorder_level - p.stock_quantity) as units_to_order,
    (p.reorder_level - p.stock_quantity) * p.price as reorder_cost
FROM products p
WHERE p.stock_quantity BETWEEN 0 AND p.reorder_level
  AND p.price BETWEEN 10 AND 1000
  AND p.category NOT IN ('Discontinued')
ORDER BY (p.reorder_level - p.stock_quantity) DESC;</code></pre>
            </div>
            
            <h4>5. Employee and HR Analytics</h4>
            <div class="code-block">
                <pre><code>-- Salary analysis by department and experience
SELECT 
    department,
    COUNT(*) as employee_count,
    AVG(salary) as avg_salary,
    MIN(salary) as min_salary,
    MAX(salary) as max_salary,
    AVG(DATEDIFF(CURRENT_DATE, hire_date) / 365) as avg_years_experience
FROM employees
WHERE salary BETWEEN 30000 AND 200000
  AND hire_date BETWEEN '2010-01-01' AND CURRENT_DATE
GROUP BY department
HAVING COUNT(*) >= 3
ORDER BY avg_salary DESC;

-- Performance review analysis
SELECT 
    e.employee_id,
    CONCAT(e.first_name, ' ', e.last_name) as full_name,
    e.department,
    e.job_title,
    e.salary,
    e.performance_rating,
    DATEDIFF(CURRENT_DATE, e.hire_date) / 365 as years_employed,
    CASE 
        WHEN e.performance_rating BETWEEN 4.5 AND 5.0 THEN 'Excellent'
        WHEN e.performance_rating BETWEEN 3.5 AND 4.4 THEN 'Good'
        WHEN e.performance_rating BETWEEN 2.5 AND 3.4 THEN 'Satisfactory'
        ELSE 'Needs Improvement'
    END as performance_category
FROM employees e
WHERE e.salary BETWEEN 40000 AND 150000
  AND e.performance_rating BETWEEN 1.0 AND 5.0
  AND e.hire_date BETWEEN DATE_SUB(CURRENT_DATE, INTERVAL 10 YEAR) AND CURRENT_DATE
ORDER BY e.performance_rating DESC, e.salary DESC;</code></pre>
            </div>
            
            <h4>6. Advanced Analytics and Reporting</h4>
            <div class="code-block">
                <pre><code>-- Customer lifetime value analysis
SELECT 
    c.customer_id,
    CONCAT(c.first_name, ' ', c.last_name) as customer_name,
    c.registration_date,
    COUNT(o.order_id) as total_orders,
    SUM(o.total_amount) as lifetime_value,
    AVG(o.total_amount) as avg_order_value,
    DATEDIFF(CURRENT_DATE, c.registration_date) as days_as_customer,
    ROUND(SUM(o.total_amount) / (DATEDIFF(CURRENT_DATE, c.registration_date) / 365), 2) as annual_value
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
WHERE c.registration_date BETWEEN DATE_SUB(CURRENT_DATE, INTERVAL 3 YEAR) AND CURRENT_DATE
  AND o.order_date BETWEEN c.registration_date AND CURRENT_DATE
  AND o.total_amount BETWEEN 10 AND 5000
GROUP BY c.customer_id, c.first_name, c.last_name, c.registration_date
HAVING COUNT(o.order_id) BETWEEN 2 AND 100
   AND SUM(o.total_amount) BETWEEN 100 AND 50000
ORDER BY lifetime_value DESC;

-- Seasonal sales trend analysis
SELECT 
    YEAR(order_date) as year,
    QUARTER(order_date) as quarter,
    MONTH(order_date) as month,
    COUNT(*) as total_orders,
    SUM(total_amount) as total_revenue,
    AVG(total_amount) as avg_order_value,
    COUNT(DISTINCT customer_id) as unique_customers
FROM orders
WHERE order_date BETWEEN DATE_SUB(CURRENT_DATE, INTERVAL 2 YEAR) AND CURRENT_DATE
  AND total_amount BETWEEN 1 AND 10000
  AND status IN ('Completed', 'Delivered')
GROUP BY YEAR(order_date), QUARTER(order_date), MONTH(order_date)
ORDER BY year DESC, quarter DESC, month DESC;</code></pre>
            </div>

            <h3>üí° Helpful Tips</h3>
            <ul>
                <li><strong>Inclusive Range</strong>: BETWEEN includes both boundary values in the result</li>
                <li><strong>Order Matters</strong>: The first value should be less than or equal to the second value</li>
                <li><strong>Performance</strong>: BETWEEN is often more efficient than >= AND <= operators</li>
                <li><strong>Date Handling</strong>: Be careful with time components in datetime fields</li>
                <li><strong>String Comparisons</strong>: BETWEEN works with strings using alphabetical order</li>
                <li><strong>NULL Values</strong>: BETWEEN returns NULL if any operand is NULL</li>
                <li><strong>Index Usage</strong>: Create indexes on columns frequently used with BETWEEN</li>
                <li><strong>Data Types</strong>: Ensure consistent data types for accurate comparisons</li>
                <li><strong>Case Sensitivity</strong>: String comparisons may be case-sensitive</li>
                <li><strong>Alternative Syntax</strong>: BETWEEN is equivalent to >= AND <=</li>
                <li><strong>NOT BETWEEN</strong>: Use for excluding ranges rather than including them</li>
                <li><strong>Complex Ranges</strong>: Combine multiple BETWEEN conditions with AND/OR for complex filtering</li>
            </ul>

            <h3>üß† Summary</h3>
            <ul>
                <li><strong>Range Filtering</strong>: BETWEEN efficiently filters data within specified ranges</li>
                <li><strong>Inclusivity</strong>: Both boundary values are included in the results</li>
                <li><strong>Versatility</strong>: Works with numbers, dates, and strings</li>
                <li><strong>Performance</strong>: More efficient than multiple comparison operators</li>
                <li><strong>Readability</strong>: Provides clean, readable syntax for range queries</li>
                <li><strong>Essential Tool</strong>: Critical for data analysis, reporting, and business intelligence</li>
            </ul>

            <h3>üß™ Practice: Find Products in Price Range</h3>
            <div class="mock-table" id="mockTable" style="display: none;">
                <h4>Preview: What the table would look like when queried:</h4>
                <h5>After Query (Example Result):</h5>
                <table>
                    <thead>
                        <tr>
                            <th>name</th>
                            <th>price</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Wireless Mouse</td>
                            <td>$75.99</td>
                        </tr>
                        <tr>
                            <td>Keyboard</td>
                            <td>$120.00</td>
                        </tr>
                        <tr>
                            <td>Monitor Stand</td>
                            <td>$89.50</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>üéØ Quiz</h3>
            <p><strong>Which operator would you use to find records where a column value falls within a specific range?</strong></p>
            <div class="quiz">
                <button onclick="checkAnswer(this, true)">A) BETWEEN</button>
                <button onclick="checkAnswer(this, false)">B) IN</button>
                <button onclick="checkAnswer(this, false)">C) LIKE</button>
                <button onclick="checkAnswer(this, false)">D) EXISTS</button>
                <p class="quiz-feedback"></p>
                <div id="quizExplanation" class="quiz-explanation" style="display: none;"></div>
            </div>
        </section>
    </div>
    <div id="footer"></div>
</body>
</html>